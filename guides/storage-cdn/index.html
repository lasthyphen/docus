<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guides/storage-cdn">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Storage CDN | Dijets Council Hub</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="http://127.0.0.1/docs/guides/storage-cdn"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Storage CDN | Dijets Council Hub"><meta data-rh="true" name="description" content="How Supabase Storage caches objects with a CDN"><meta data-rh="true" property="og:description" content="How Supabase Storage caches objects with a CDN"><link data-rh="true" rel="icon" href="/docs/favicon.ico"><link data-rh="true" rel="canonical" href="http://127.0.0.1/docs/guides/storage-cdn"><link data-rh="true" rel="alternate" href="http://127.0.0.1/docs/guides/storage-cdn" hreflang="en"><link data-rh="true" rel="alternate" href="http://127.0.0.1/docs/guides/storage-cdn" hreflang="x-default"><link rel="search" type="application/opensearchdescription+xml" title="Dijets Council Hub" href="/docs/opensearch.xml">
<script src="/docs/scripts/telemetry.js"></script><link rel="stylesheet" href="/docs/assets/css/styles.13ffe8e7.css">
<link rel="preload" href="/docs/assets/js/runtime~main.23337c97.js" as="script">
<link rel="preload" href="/docs/assets/js/main.57ad0143.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://council.dijets.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/docs/img/supabase-logo-wordmark--light.svg" alt="Dijets Council Docs" class="themedImage_ToTc themedImage--light_HNdA"><img src="/docs/img/supabase-logo-wordmark--dark.svg" alt="Dijets Council Docs" class="themedImage_ToTc themedImage--dark_i4oU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">Guides</a><a class="navbar__item navbar__link" href="/docs/reference">Reference Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://dips.dijets.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">DIPs Directory</a><a href="https://github.com/Dijets-Inc" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-item-github"></a><a href="https://qowalts.dijets.io" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-item-discord"></a><a href="https://twitter.com/OfficialDijets" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link navbar-item-twitter"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Storage CDN</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cdn-basics">CDN basics<a class="hash-link" href="#cdn-basics" title="Direct link to heading">​</a></h2><p>All assets uploaded to storage are cached on a Content Delivery Network (CDN).</p><p>To improve the latency for users all around the world, Supabase uses a CDN. CDNs are a geographically distributed set of servers or <strong>nodes</strong> which caches content from an <strong>origin server</strong>. For Supabase Storage, the origin is the storage server running in the <a href="https://app.supabase.com/project/_/settings/general" target="_blank" rel="noopener noreferrer">same region as your project</a>.</p><p>Let’s walk through an example of how a CDN helps with performance. A new bucket is created for a Supabase project launched in Singapore. All requests to the Supabase Storage API first hit the CDN. A user from the United States requests an object and is routed to the U.S. CDN. At this point, that CDN node does not have the object in its cache and pings the origin server in Singapore. Another user, also in the United States, requests the same object and is served directly from the CDN cache in the United States instead of routing the request back to Singapore.</p><p>Aside from performance, CDNs also help with security and availability by mitigating Distributed Denial of Service and other application attacks.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cache-duration">Cache duration<a class="hash-link" href="#cache-duration" title="Direct link to heading">​</a></h2><p>By default, assets are cached both in the CDN and in the user’s browser for 1 hour. After this, the CDN nodes ping the storage server to see if an object has been updated.</p><p>You can modify this cache time when you are <a href="https://supabase.com/docs/reference/javascript/storage-from-upload" target="_blank" rel="noopener noreferrer">uploading</a> or <a href="https://supabase.com/docs/reference/javascript/storage-from-update" target="_blank" rel="noopener noreferrer">updating</a> an object by modifying the <code>cacheControl</code> parameter.</p><p>If you expect the object to not change at a given URL, setting a longer cache duration is preferable.</p><p>If you need to update the version of the object stored in the CDN, there are various cache-busting techniques you can use. The most common way to do this is to add a version query parameter in the URL. For example, you can use a URL like <code>/storage/v1/object/sign/profile-pictures/cat.jpg?token=eyJh...&amp;version=1</code> in your applications and set a long cache time of 1 year. When you want to update the cat picture, you can increment the version query parameter in the URL. The CDN will treat <code>/storage/v1/object/sign/profile-pictures/cat.jpg?token=eyJh...&amp;version=2</code> as a new object and pings the origin for the updated version.</p><p>Note that CDNs might still evict your object from their cache if it has not been requested for a while from a specific region. For example, if no user from United States requests your object, it will be removed from the CDN cache even if you set a very long cache control duration.</p><p>The cache status of a particular request is sent in the <code>cf-cache-status</code> header. A cache status of <code>MISS</code> indicates that the CDN node did not have the object in its cache and had to ping the origin to get it. A cache status of <code>HIT</code> indicates that the object was sent directly from the CDN.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="public-vs-private-buckets">Public vs Private Buckets<a class="hash-link" href="#public-vs-private-buckets" title="Direct link to heading">​</a></h2><p>Objects in public buckets do not require any Authorization to access objects. This leads to a better cache hit rate compared to private buckets. For private buckets, permissions for accessing each object is checked on a per user level. For example, if two different users access the same object in a private bucket from the same region, it results in a cache miss for both the users since they might have different security policies attached to them. On the other hand, if two different users access the same object in a public bucket from the same region, it results in a cache hit for the second user.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/docs/guides/storage-cdn.mdx" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#cdn-basics" class="table-of-contents__link toc-highlight">CDN basics</a></li><li><a href="#cache-duration" class="table-of-contents__link toc-highlight">Cache duration</a></li><li><a href="#public-vs-private-buckets" class="table-of-contents__link toc-highlight">Public vs Private Buckets</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 Dijets Inc.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.23337c97.js"></script>
<script src="/docs/assets/js/main.57ad0143.js"></script>
</body>
</html>