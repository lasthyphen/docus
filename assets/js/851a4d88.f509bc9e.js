"use strict";(self.webpackChunkreference_docs=self.webpackChunkreference_docs||[]).push([[81486],{3905:(e,a,t)=>{t.d(a,{Zo:()=>u,kt:()=>b});var r=t(67294);function l(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}function n(e,a){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);a&&(r=r.filter((function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var a=1;a<arguments.length;a++){var t=null!=arguments[a]?arguments[a]:{};a%2?n(Object(t),!0).forEach((function(a){l(e,a,t[a])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):n(Object(t)).forEach((function(a){Object.defineProperty(e,a,Object.getOwnPropertyDescriptor(t,a))}))}return e}function s(e,a){if(null==e)return{};var t,r,l=function(e,a){if(null==e)return{};var t,r,l={},n=Object.keys(e);for(r=0;r<n.length;r++)t=n[r],a.indexOf(t)>=0||(l[t]=e[t]);return l}(e,a);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(r=0;r<n.length;r++)t=n[r],a.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(l[t]=e[t])}return l}var i=r.createContext({}),c=function(e){var a=r.useContext(i),t=a;return e&&(t="function"==typeof e?e(a):o(o({},a),e)),t},u=function(e){var a=c(e.components);return r.createElement(i.Provider,{value:a},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var a=e.children;return r.createElement(r.Fragment,{},a)}},m=r.forwardRef((function(e,a){var t=e.components,l=e.mdxType,n=e.originalType,i=e.parentName,u=s(e,["components","mdxType","originalType","parentName"]),p=c(t),m=l,b=p["".concat(i,".").concat(m)]||p[m]||d[m]||n;return t?r.createElement(b,o(o({ref:a},u),{},{components:t})):r.createElement(b,o({ref:a},u))}));function b(e,a){var t=arguments,l=a&&a.mdxType;if("string"==typeof e||l){var n=t.length,o=new Array(n);o[0]=m;var s={};for(var i in a)hasOwnProperty.call(a,i)&&(s[i]=a[i]);s.originalType=e,s[p]="string"==typeof e?e:l,o[1]=s;for(var c=2;c<n;c++)o[c]=t[c];return r.createElement.apply(null,o)}return r.createElement.apply(null,t)}m.displayName="MDXCreateElement"},85162:(e,a,t)=>{t.d(a,{Z:()=>o});var r=t(67294),l=t(86010);const n="tabItem_Ymn6";function o(e){let{children:a,hidden:t,className:o}=e;return r.createElement("div",{role:"tabpanel",className:(0,l.Z)(n,o),hidden:t},a)}},65488:(e,a,t)=>{t.d(a,{Z:()=>m});var r=t(87462),l=t(67294),n=t(86010),o=t(72389),s=t(67392),i=t(7094),c=t(12466);const u="tabList__CuJ",p="tabItem_LNqP";function d(e){const{lazy:a,block:t,defaultValue:o,values:d,groupId:m,className:b}=e,k=l.Children.map(e.children,(e=>{if((0,l.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),h=d??k.map((e=>{let{props:{value:a,label:t,attributes:r}}=e;return{value:a,label:t,attributes:r}})),g=(0,s.l)(h,((e,a)=>e.value===a.value));if(g.length>0)throw new Error(`Docusaurus error: Duplicate values "${g.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const f=null===o?o:o??k.find((e=>e.props.default))?.props.value??k[0].props.value;if(null!==f&&!h.some((e=>e.value===f)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${f}" but none of its children has the corresponding value. Available values are: ${h.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:v,setTabGroupChoices:y}=(0,i.U)(),[N,w]=(0,l.useState)(f),S=[],{blockElementScrollPositionUntilNextRender:j}=(0,c.o5)();if(null!=m){const e=v[m];null!=e&&e!==N&&h.some((a=>a.value===e))&&w(e)}const x=e=>{const a=e.currentTarget,t=S.indexOf(a),r=h[t].value;r!==N&&(j(a),w(r),null!=m&&y(m,String(r)))},T=e=>{let a=null;switch(e.key){case"Enter":x(e);break;case"ArrowRight":{const t=S.indexOf(e.currentTarget)+1;a=S[t]??S[0];break}case"ArrowLeft":{const t=S.indexOf(e.currentTarget)-1;a=S[t]??S[S.length-1];break}}a?.focus()};return l.createElement("div",{className:(0,n.Z)("tabs-container",u)},l.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,n.Z)("tabs",{"tabs--block":t},b)},h.map((e=>{let{value:a,label:t,attributes:o}=e;return l.createElement("li",(0,r.Z)({role:"tab",tabIndex:N===a?0:-1,"aria-selected":N===a,key:a,ref:e=>S.push(e),onKeyDown:T,onClick:x},o,{className:(0,n.Z)("tabs__item",p,o?.className,{"tabs__item--active":N===a})}),t??a)}))),a?(0,l.cloneElement)(k.filter((e=>e.props.value===N))[0],{className:"margin-top--md"}):l.createElement("div",{className:"margin-top--md"},k.map(((e,a)=>(0,l.cloneElement)(e,{key:a,hidden:e.props.value!==N})))))}function m(e){const a=(0,o.Z)();return l.createElement(d,(0,r.Z)({key:String(a)},e))}},94784:(e,a,t)=>{t.r(a),t.d(a,{assets:()=>u,contentTitle:()=>i,default:()=>m,frontMatter:()=>s,metadata:()=>c,toc:()=>p});var r=t(87462),l=(t(67294),t(3905)),n=t(65488),o=t(85162);const s={id:"storage",title:"Storage",description:"Use Supabase to store and serve files.",sidebar_label:"Overview"},i=void 0,c={unversionedId:"guides/storage",id:"guides/storage",title:"Storage",description:"Use Supabase to store and serve files.",source:"@site/docs/guides/storage.mdx",sourceDirName:"guides",slug:"/guides/storage",permalink:"/docs/guides/storage",draft:!1,editUrl:"https://github.com/docs/guides/storage.mdx",tags:[],version:"current",frontMatter:{id:"storage",title:"Storage",description:"Use Supabase to store and serve files.",sidebar_label:"Overview"}},u={},p=[{value:"Files",id:"files",level:3},{value:"Folders",id:"folders",level:3},{value:"Buckets",id:"buckets",level:3},{value:"Getting started",id:"getting-started",level:2},{value:"Create a bucket",id:"create-a-bucket",level:3},{value:"Upload a file",id:"upload-a-file",level:3},{value:"Download a file",id:"download-a-file",level:3},{value:"Add security rules",id:"add-security-rules",level:3},{value:"Public and Private Buckets",id:"public-and-private-buckets",level:2},{value:"Access control",id:"access-control",level:2},{value:"Helpers",id:"helpers",level:2},{value:"<code>storage.filename()</code>",id:"storagefilename",level:4},{value:"<code>storage.foldername()</code>",id:"storagefoldername",level:4},{value:"<code>storage.extension()</code>",id:"storageextension",level:4},{value:"Policy examples",id:"policy-examples",level:2},{value:"Allow public access to a bucket",id:"allow-public-access-to-a-bucket",level:3},{value:"Allow logged-in access to a bucket",id:"allow-logged-in-access-to-a-bucket",level:3},{value:"Allow individual access to a file",id:"allow-individual-access-to-a-file",level:3},{value:"See also",id:"see-also",level:2}],d={toc:p};function m(e){let{components:a,...t}=e;return(0,l.kt)("wrapper",(0,r.Z)({},d,t,{components:a,mdxType:"MDXLayout"}),(0,l.kt)("p",null,"Supabase Storage makes it simple to store and serve large files."),(0,l.kt)("h3",{id:"files"},"Files"),(0,l.kt)("p",null,"Files can be any sort of media file. This includes images, GIFs, and videos. It is best practice to store files outside of your database because of their sizes."),(0,l.kt)("h3",{id:"folders"},"Folders"),(0,l.kt)("p",null,"Folders are a way to organize your files (just like on your computer).\nThere is no right or wrong way to\norganize your files. You can store them in whichever folder structure suits your project."),(0,l.kt)("h3",{id:"buckets"},"Buckets"),(0,l.kt)("p",null,'Buckets are distinct containers for files and folders. You can think of them like "super folders".\nGenerally you would create distinct buckets for different Security and Access Rules. For example, you might\nkeep all video files in a "video" bucket, and profile pictures in an "avatar" bucket.'),(0,l.kt)("div",{class:"video-container"},(0,l.kt)("iframe",{src:"https://www.youtube-nocookie.com/embed/J9mTPY8rIXE",frameBorder:"1",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})),(0,l.kt)("h2",{id:"getting-started"},"Getting started"),(0,l.kt)("p",null,"This is a quick guide that shows the basic functionality of Supabase Storage. Find a full\n",(0,l.kt)("a",{parentName:"p",href:"https://github.com/supabase/supabase/tree/master/examples/user-management/nextjs-ts-user-management"},"example application in GitHub"),",\nwhich you can deploy yourself."),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://vercel.com/new/git/external?repository-url=https%3A%2F%2Fgithub.com%2Fsupabase%2Fsupabase%2Ftree%2Fmaster%2Fexamples%2Fuser-management%2Fnextjs-ts-user-management&project-name=supabase-user-management&repository-name=supabase-user-management&demo-title=Supabase%20User%20Management&demo-description=An%20example%20web%20app%20using%20Supabase%20and%20Next.js&demo-url=https%3A%2F%2Fsupabase-nextjs-ts-user-management.vercel.app&demo-image=https%3A%2F%2Fi.imgur.com%2FZ3HkQqe.png&integration-ids=oac_jUduyjQgOyzev1fjrW83NYOv&external-id=nextjs-user-management"},(0,l.kt)("img",{parentName:"a",src:"https://vercel.com/button",alt:"Deploy with Vercel"}))),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"File, Folder, and Bucket names ",(0,l.kt)("strong",{parentName:"p"},"must follow")," ",(0,l.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/AmazonS3/latest/userguide/object-keys.html"},"AWS object key naming guidelines")," and avoid use of any other characters.")),(0,l.kt)("h3",{id:"create-a-bucket"},"Create a bucket"),(0,l.kt)("p",null,'You can create a bucket using the Supabase Dashboard.\nSince the storage is interoperable with your Postgres database, you can also use SQL or our\nclient libraries. Here we create a bucket called "avatars":'),(0,l.kt)(n.Z,{groupId:"storage-tabs",defaultValue:"dashboard",values:[{label:"Dashboard",value:"dashboard"},{label:"SQL",value:"sql"},{label:"JavaScript",value:"javascript"},{label:"Dart",value:"dart"}],mdxType:"Tabs"},(0,l.kt)(o.Z,{value:"dashboard",mdxType:"TabItem"},(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Go to the ",(0,l.kt)("a",{parentName:"li",href:"https://app.supabase.com/project/_/storage/buckets"},"Storage")," page in the Dashboard."),(0,l.kt)("li",{parentName:"ol"},"Click ",(0,l.kt)("strong",{parentName:"li"},"New Bucket")," and enter a name for the bucket."),(0,l.kt)("li",{parentName:"ol"},"Click ",(0,l.kt)("strong",{parentName:"li"},"Create Bucket"),"."))),(0,l.kt)(o.Z,{value:"sql",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"-- Use Postgres to create a bucket.\n\ninsert into storage.buckets (id, name)\nvalues ('avatars', 'avatars');\n"))),(0,l.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// Use the JS library to create a bucket.\n\nconst { data, error } = await supabase.storage.createBucket('avatars')\n")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"/docs/reference/javascript/storage-createbucket"},"Reference."))),(0,l.kt)(o.Z,{value:"dart",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-dart"},"void main() async {\n  final client = SupabaseClient('supabaseUrl', 'supabaseKey');\n\n  final storageResponse = await client\n      .storage\n      .createBucket('avatars');\n}\n")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"https://pub.dev/documentation/storage_client/latest/storage_client/SupabaseStorageClient/createBucket.html"},"Reference.")))),(0,l.kt)("h3",{id:"upload-a-file"},"Upload a file"),(0,l.kt)("p",null,"You can upload a file from the Dashboard, or within a browser using our JS libraries."),(0,l.kt)(n.Z,{groupId:"storage-tabs",defaultValue:"dashboard",values:[{label:"Dashboard",value:"dashboard"},{label:"JavaScript",value:"javascript"},{label:"Dart",value:"dart"}],mdxType:"Tabs"},(0,l.kt)(o.Z,{value:"dashboard",mdxType:"TabItem"},(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Go to the ",(0,l.kt)("a",{parentName:"li",href:"https://app.supabase.com/project/_/storage/buckets"},"Storage")," page in the Dashboard."),(0,l.kt)("li",{parentName:"ol"},"Select the bucket you want to upload the file to."),(0,l.kt)("li",{parentName:"ol"},"Click ",(0,l.kt)("strong",{parentName:"li"},"Upload File"),"."),(0,l.kt)("li",{parentName:"ol"},"Select the file you want to upload."))),(0,l.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const avatarFile = event.target.files[0]\nconst { data, error } = await supabase.storage\n  .from('avatars')\n  .upload('public/avatar1.png', avatarFile)\n")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"/docs/reference/javascript/storage-from-upload"},"Reference."))),(0,l.kt)(o.Z,{value:"dart",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-dart"},"void main() async {\n  final client = SupabaseClient('supabaseUrl', 'supabaseKey');\n\n  // Create file `example.txt` and upload it in `public` bucket\n  final file = File('example.txt');\n  file.writeAsStringSync('File content');\n  final storageResponse = await client\n      .storage\n      .from('public')\n      .upload('example.txt', file);\n}\n")))),(0,l.kt)("h3",{id:"download-a-file"},"Download a file"),(0,l.kt)("p",null,"You can download a file from the Dashboard, or within a browser using our JS libraries."),(0,l.kt)(n.Z,{groupId:"storage-tabs",defaultValue:"dashboard",values:[{label:"Dashboard",value:"dashboard"},{label:"JavaScript",value:"javascript"},{label:"Dart",value:"dart"}],mdxType:"Tabs"},(0,l.kt)(o.Z,{value:"dashboard",mdxType:"TabItem"},(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Go to the ",(0,l.kt)("a",{parentName:"li",href:"https://app.supabase.com/project/_/storage/buckets"},"Storage")," page in the Dashboard."),(0,l.kt)("li",{parentName:"ol"},"Select the bucket that contains the file."),(0,l.kt)("li",{parentName:"ol"},"Select the file that you want to download."),(0,l.kt)("li",{parentName:"ol"},"Click ",(0,l.kt)("strong",{parentName:"li"},"Download"),"."))),(0,l.kt)(o.Z,{value:"javascript",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"// Use the JS library to download a file.\n\nconst { data, error } = await supabase.storage\n  .from('avatars')\n  .download('public/avatar1.png')\n")),(0,l.kt)("p",null,(0,l.kt)("a",{parentName:"p",href:"/docs/reference/javascript/storage-from-download"},"Reference."))),(0,l.kt)(o.Z,{value:"dart",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-dart"},"void main() async {\n  final client = SupabaseClient('supabaseUrl', 'supabaseKey');\n\n  final storageResponse = await client\n      .storage\n      .from('public')\n      .download('example.txt');\n}\n")))),(0,l.kt)("h3",{id:"add-security-rules"},"Add security rules"),(0,l.kt)("p",null,"To restrict access to your files you can use either the Dashboard or SQL."),(0,l.kt)(n.Z,{groupId:"storage-tabs",defaultValue:"dashboard",values:[{label:"Dashboard",value:"dashboard"},{label:"SQL",value:"sql"}],mdxType:"Tabs"},(0,l.kt)(o.Z,{value:"dashboard",mdxType:"TabItem"},(0,l.kt)("ol",null,(0,l.kt)("li",{parentName:"ol"},"Go to the ",(0,l.kt)("a",{parentName:"li",href:"https://app.supabase.com/project/_/storage/buckets"},"Storage")," page in the Dashboard."),(0,l.kt)("li",{parentName:"ol"},"Click ",(0,l.kt)("strong",{parentName:"li"},"Policies")," in the sidebar."),(0,l.kt)("li",{parentName:"ol"},"Click ",(0,l.kt)("strong",{parentName:"li"},"Add Policies")," in the ",(0,l.kt)("inlineCode",{parentName:"li"},"OBJECTS")," table to add policies for Files. You can also create policies for Buckets."),(0,l.kt)("li",{parentName:"ol"},"Choose whether you want the policy to apply to downloads (SELECT), uploads (INSERT), updates (UPDATE), or deletes (DELETE)."),(0,l.kt)("li",{parentName:"ol"},"Give your policy a unique name."),(0,l.kt)("li",{parentName:"ol"},"Write the policy using SQL."))),(0,l.kt)(o.Z,{value:"sql",mdxType:"TabItem"},(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"-- Use SQL to create a policy.\n\ncreate policy \"Public Access\"\n  on storage.objects for select\n  using ( bucket_id = 'public' );\n")))),(0,l.kt)("h2",{id:"public-and-private-buckets"},"Public and Private Buckets"),(0,l.kt)("p",null,"Storage buckets are private by default."),(0,l.kt)("p",null,"For private buckets, you can access objects via the ",(0,l.kt)("a",{parentName:"p",href:"/docs/reference/javascript/storage-from-download"},"download")," method. This corresponds to ",(0,l.kt)("inlineCode",{parentName:"p"},"/object/auth/")," API endpoint.\nAlternatively, you can create a publicly shareable URL with an expiry date using the ",(0,l.kt)("a",{parentName:"p",href:"/docs/reference/javascript/storage-from-createsignedurl"},"createSignedUrl")," method\nwhich calls the ",(0,l.kt)("inlineCode",{parentName:"p"},"/object/sign/")," API."),(0,l.kt)("p",null,"For public buckets, you can access the assets directly without a token or an Authorisation header. The ",(0,l.kt)("a",{parentName:"p",href:"/docs/reference/javascript/storage-from-getpublicurl"},"getPublicUrl"),"\nhelper method returns the full public URL for an asset. This calls the ",(0,l.kt)("inlineCode",{parentName:"p"},"/object/public/")," API endpoint internally. While no authorization is required for accessing objects in a public bucket, proper ",(0,l.kt)("a",{parentName:"p",href:"#access-control"},"access control")," is required for other operations like uploading, deleting objects from public buckets as well."),(0,l.kt)("p",null,"Public buckets also tend to have ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/storage-cdn#public-vs-private-buckets"},"better performance"),"."),(0,l.kt)("details",null,(0,l.kt)("summary",null,"Advanced: reverse proxy"),"The URLs returned are proxied through the API Proxy. They are prefixed by ",(0,l.kt)("code",null,"/storage/v1"),".",(0,l.kt)("p",null,"For example, on the hosted Platform they will be"),(0,l.kt)("code",null,"https://[project_ref].supabase.co/storage/v1/object/public/[id]"),(0,l.kt)("p",null,"You can access the storage API directly with the same endpoint. See the ",(0,l.kt)("a",{href:"https://supabase.github.io/storage-api"},"API docs")," for a full list of operations available.")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"access-control"},"Access control"),(0,l.kt)("p",null,"Supabase Storage is integrated with your ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/database"},"Postgres Database"),".\nThis means that you can use the same ",(0,l.kt)("a",{parentName:"p",href:"/docs/guides/auth#policies"},"Row Level Security Policies"),"\nfor managing access to your files. Supabase Storage stores metadata in the ",(0,l.kt)("inlineCode",{parentName:"p"},"objects")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"buckets")," table in the storage schema. To allow read access to files, the RLS policy must allow users to ",(0,l.kt)("inlineCode",{parentName:"p"},"SELECT")," the ",(0,l.kt)("inlineCode",{parentName:"p"},"objects")," table and for uploading a new object, the RLS policy must grant users access to ",(0,l.kt)("inlineCode",{parentName:"p"},"INSERT")," into the ",(0,l.kt)("inlineCode",{parentName:"p"},"objects")," table and so on. The mapping between the different API calls and the database permissions required is documented in the ",(0,l.kt)("a",{parentName:"p",href:"/docs/reference/javascript/storage-createbucket"},"Reference docs"),"."),(0,l.kt)("admonition",{type:"note"},(0,l.kt)("p",{parentName:"admonition"},"Access control for Storage is mapped to CRUD operations on the ",(0,l.kt)("inlineCode",{parentName:"p"},"buckets")," and ",(0,l.kt)("inlineCode",{parentName:"p"},"objects")," table via RLS policies.")),(0,l.kt)("h2",{id:"helpers"},"Helpers"),(0,l.kt)("p",null,"Supabase Storage provides SQL helper functions which you can use in your database queries and\npolicies."),(0,l.kt)("hr",null),(0,l.kt)("h4",{id:"storagefilename"},(0,l.kt)("inlineCode",{parentName:"h4"},"storage.filename()")),(0,l.kt)("p",null,"Returns the name of a file."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"select storage.filename(name)\nfrom storage.objects;\n")),(0,l.kt)("p",null,"For example, if your file is stored in ",(0,l.kt)("inlineCode",{parentName:"p"},"public/subfolder/avatar.png")," it would return:"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"'avatar.png'")),(0,l.kt)("hr",null),(0,l.kt)("h4",{id:"storagefoldername"},(0,l.kt)("inlineCode",{parentName:"h4"},"storage.foldername()")),(0,l.kt)("p",null,"Returns an array path, with all of the subfolders that a file belongs to."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"select storage.foldername(name)\nfrom storage.objects;\n")),(0,l.kt)("p",null,"For example, if your file is stored in ",(0,l.kt)("inlineCode",{parentName:"p"},"public/subfolder/avatar.png")," it would return:"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"[ 'public', 'subfolder' ]")),(0,l.kt)("hr",null),(0,l.kt)("h4",{id:"storageextension"},(0,l.kt)("inlineCode",{parentName:"h4"},"storage.extension()")),(0,l.kt)("p",null,"Returns the extension of a file."),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"select storage.extension(name)\nfrom storage.objects;\n")),(0,l.kt)("p",null,"For example, if your file is stored in ",(0,l.kt)("inlineCode",{parentName:"p"},"public/subfolder/avatar.png")," it would return:"),(0,l.kt)("p",null,(0,l.kt)("inlineCode",{parentName:"p"},"'png'")),(0,l.kt)("hr",null),(0,l.kt)("h2",{id:"policy-examples"},"Policy examples"),(0,l.kt)("p",null,"Here are some examples of storage policies."),(0,l.kt)("h3",{id:"allow-public-access-to-a-bucket"},"Allow public access to a bucket"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},'-- 1. Allow public access to any files in the "public" bucket\ncreate policy "Public Access"\non storage.objects for select\nusing ( bucket_id = \'public\' );\n')),(0,l.kt)("h3",{id:"allow-logged-in-access-to-a-bucket"},"Allow logged-in access to a bucket"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},"-- 1. Allow logged-in access to any files in the \"restricted\" bucket\ncreate policy \"Restricted Access\"\non storage.objects for select\nusing (\n  bucket_id = 'restricted'\n  and auth.role() = 'authenticated'\n);\n")),(0,l.kt)("h3",{id:"allow-individual-access-to-a-file"},"Allow individual access to a file"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-sql"},'-- 1. Allow a user to access their own files\ncreate policy "Individual user Access"\non storage.objects for select\nusing ( auth.uid() = owner );\n')),(0,l.kt)("h2",{id:"see-also"},"See also"),(0,l.kt)("ul",null,(0,l.kt)("li",{parentName:"ul"},"Read more about Supabase Storage in the ",(0,l.kt)("a",{parentName:"li",href:"https://supabase.com/blog/supabase-storage"},"blog post")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/supabase/storage-api"},"Supabase Storage on GitHub")),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://supabase.github.io/storage-api"},"Swagger API documentation")),(0,l.kt)("li",{parentName:"ul"},"Official ",(0,l.kt)("a",{parentName:"li",href:"/docs/reference/javascript/storage-createbucket"},"JavaScript")," and ",(0,l.kt)("a",{parentName:"li",href:"/docs/reference/dart/storage-createbucket"},"Dart")," documentation"),(0,l.kt)("li",{parentName:"ul"},(0,l.kt)("a",{parentName:"li",href:"https://github.com/supabase-community"},"Community libraries"))))}m.isMDXComponent=!0}}]);