"use strict";(self.webpackChunkreference_docs=self.webpackChunkreference_docs||[]).push([[67973],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>h});var a=n(67294);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var l=a.createContext({}),u=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(l.Provider,{value:t},e.children)},p="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,o=e.mdxType,i=e.originalType,l=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),p=u(n),m=o,h=p["".concat(l,".").concat(m)]||p[m]||d[m]||i;return n?a.createElement(h,r(r({ref:t},c),{},{components:n})):a.createElement(h,r({ref:t},c))}));function h(e,t){var n=arguments,o=t&&t.mdxType;if("string"==typeof e||o){var i=n.length,r=new Array(i);r[0]=m;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s[p]="string"==typeof e?e:o,r[1]=s;for(var u=2;u<i;u++)r[u]=n[u];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},85162:(e,t,n)=>{n.d(t,{Z:()=>r});var a=n(67294),o=n(86010);const i="tabItem_Ymn6";function r(e){let{children:t,hidden:n,className:r}=e;return a.createElement("div",{role:"tabpanel",className:(0,o.Z)(i,r),hidden:n},t)}},65488:(e,t,n)=>{n.d(t,{Z:()=>m});var a=n(87462),o=n(67294),i=n(86010),r=n(72389),s=n(67392),l=n(7094),u=n(12466);const c="tabList__CuJ",p="tabItem_LNqP";function d(e){const{lazy:t,block:n,defaultValue:r,values:d,groupId:m,className:h}=e,g=o.Children.map(e.children,(e=>{if((0,o.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),k=d??g.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),f=(0,s.l)(k,((e,t)=>e.value===t.value));if(f.length>0)throw new Error(`Docusaurus error: Duplicate values "${f.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const b=null===r?r:r??g.find((e=>e.props.default))?.props.value??g[0].props.value;if(null!==b&&!k.some((e=>e.value===b)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${b}" but none of its children has the corresponding value. Available values are: ${k.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:v}=(0,l.U)(),[N,w]=(0,o.useState)(b),E=[],{blockElementScrollPositionUntilNextRender:C}=(0,u.o5)();if(null!=m){const e=y[m];null!=e&&e!==N&&k.some((t=>t.value===e))&&w(e)}const S=e=>{const t=e.currentTarget,n=E.indexOf(t),a=k[n].value;a!==N&&(C(t),w(a),null!=m&&v(m,String(a)))},T=e=>{let t=null;switch(e.key){case"Enter":S(e);break;case"ArrowRight":{const n=E.indexOf(e.currentTarget)+1;t=E[n]??E[0];break}case"ArrowLeft":{const n=E.indexOf(e.currentTarget)-1;t=E[n]??E[E.length-1];break}}t?.focus()};return o.createElement("div",{className:(0,i.Z)("tabs-container",c)},o.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.Z)("tabs",{"tabs--block":n},h)},k.map((e=>{let{value:t,label:n,attributes:r}=e;return o.createElement("li",(0,a.Z)({role:"tab",tabIndex:N===t?0:-1,"aria-selected":N===t,key:t,ref:e=>E.push(e),onKeyDown:T,onClick:S},r,{className:(0,i.Z)("tabs__item",p,r?.className,{"tabs__item--active":N===t})}),n??t)}))),t?(0,o.cloneElement)(g.filter((e=>e.props.value===N))[0],{className:"margin-top--md"}):o.createElement("div",{className:"margin-top--md"},g.map(((e,t)=>(0,o.cloneElement)(e,{key:t,hidden:e.props.value!==N})))))}function m(e){const t=(0,r.Z)();return o.createElement(d,(0,a.Z)({key:String(t)},e))}},11582:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>r,default:()=>p,frontMatter:()=>i,metadata:()=>s,toc:()=>u});var a=n(87462),o=(n(67294),n(3905));n(65488),n(85162);const i={id:"functions",title:"Edge Functions",description:"Globally distributed TypeScript functions.",sidebar_label:"Overview"},r=void 0,s={unversionedId:"guides/functions",id:"guides/functions",title:"Edge Functions",description:"Globally distributed TypeScript functions.",source:"@site/docs/guides/functions.mdx",sourceDirName:"guides",slug:"/guides/functions",permalink:"/docs/guides/functions",draft:!1,editUrl:"https://github.com/docs/guides/functions.mdx",tags:[],version:"current",frontMatter:{id:"functions",title:"Edge Functions",description:"Globally distributed TypeScript functions.",sidebar_label:"Overview"}},l={},u=[{value:"Quickstart",id:"quickstart",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Creating a function",id:"creating-a-function",level:3},{value:"Deploy to production",id:"deploy-to-production",level:3},{value:"Executing Remote Functions",id:"executing-remote-functions",level:3},{value:"Debugging your Functions",id:"debugging-your-functions",level:2},{value:"Developing locally",id:"developing-locally",level:2},{value:"Invoking Functions locally",id:"invoking-functions-locally",level:3},{value:"Secrets and Environment Variables",id:"secrets-and-environment-variables",level:2},{value:"Default secrets",id:"default-secrets",level:3},{value:"Local secrets",id:"local-secrets",level:3},{value:"Production secrets",id:"production-secrets",level:3},{value:"Suggestions",id:"suggestions",level:2},{value:"Database Functions vs Edge Functions",id:"database-functions-vs-edge-functions",level:3},{value:"Organizing your Edge Functions",id:"organizing-your-edge-functions",level:3},{value:"Naming Edge Functions",id:"naming-edge-functions",level:3},{value:"CORS (Cross-Origin Resource Sharing)",id:"cors-cross-origin-resource-sharing",level:3},{value:"Limitations",id:"limitations",level:2}],c={toc:u};function p(e){let{components:t,...i}=e;return(0,o.kt)("wrapper",(0,a.Z)({},c,i,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("p",null,"Edge Functions are server-side TypeScript functions, distributed globally at the edge\u2014close to your users. They can be used for listening to webhooks or integrating your Supabase project with third-parties ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/supabase/supabase/tree/master/examples/edge-functions/supabase/functions/stripe-webhooks"},"like Stripe"),"."),(0,o.kt)("p",null,"Edge Functions are developed using ",(0,o.kt)("a",{parentName:"p",href:"https://deno.com"},"Deno"),", which offers a few benefits to you as a developer:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"It is open source."),(0,o.kt)("li",{parentName:"ul"},"It is portable. Supabase Edge Functions run locally, and on any other Deno-compatible platform (including self-hosted infrastructure)."),(0,o.kt)("li",{parentName:"ul"},"It is TypeScript first and supports WASM."),(0,o.kt)("li",{parentName:"ul"},"Edge Functions are globally distributed for low-latency.")),(0,o.kt)("h2",{id:"quickstart"},"Quickstart"),(0,o.kt)("p",null,"Learn how to develop Edge Functions in less than 7 minutes:"),(0,o.kt)("div",{class:"video-container"},(0,o.kt)("iframe",{src:"https://www.youtube-nocookie.com/embed/rzglqRdZUQE",frameBorder:"1",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture",allowFullScreen:!0})),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"Follow the steps to prepare your Supabase project on your local machine."),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Install the Supabase CLI. ",(0,o.kt)("a",{parentName:"li",href:"/docs/guides/cli"},"Docs"),"."),(0,o.kt)("li",{parentName:"ul"},"Login to the CLI using the command: ",(0,o.kt)("inlineCode",{parentName:"li"},"supabase login"),". ",(0,o.kt)("a",{parentName:"li",href:"/docs/reference/cli/usage#supabase-login"},"Docs"),"."),(0,o.kt)("li",{parentName:"ul"},"Initialize Supabase inside your project using the command: ",(0,o.kt)("inlineCode",{parentName:"li"},"supabase init"),". ",(0,o.kt)("a",{parentName:"li",href:"/docs/guides/cli/local-development#getting-started"},"Docs"),"."),(0,o.kt)("li",{parentName:"ul"},"Link to your Remote Project using the command ",(0,o.kt)("inlineCode",{parentName:"li"},"supabase link --project-ref your-project-ref"),". ",(0,o.kt)("a",{parentName:"li",href:"/docs/reference/cli/usage#supabase-link"},"Docs"),"."),(0,o.kt)("li",{parentName:"ul"},"Optional: Setup your environment: Follow ",(0,o.kt)("a",{parentName:"li",href:"https://deno.land/manual/getting_started/setup_your_environment"},"this setup guide")," to integrate the Deno language server with your editor.")),(0,o.kt)("h2",{id:"getting-started"},"Getting Started"),(0,o.kt)("p",null,"Let's build an Edge Function locally, then deploy it to the Supabase Platform."),(0,o.kt)("h3",{id:"creating-a-function"},"Creating a function"),(0,o.kt)("p",null,"Let's create a new Edge Function called ",(0,o.kt)("inlineCode",{parentName:"p"},"hello-world")," inside your project:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"supabase functions new hello-world\n")),(0,o.kt)("p",null,"This creates a function stub in your ",(0,o.kt)("inlineCode",{parentName:"p"},"supabase")," folder at ",(0,o.kt)("inlineCode",{parentName:"p"},"./functions/hello-world/index.ts"),"."),(0,o.kt)("h3",{id:"deploy-to-production"},"Deploy to production"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"supabase functions deploy hello-world\n")),(0,o.kt)("p",null,"This command bundles your Edge Function from ",(0,o.kt)("inlineCode",{parentName:"p"},"./functions/hello-world/index.ts")," and deploys it to the Supabase platform.\nThe command outputs a URL to the Supabase Dashboard which you can open to find view more details. Let's open the link to find the execution command."),(0,o.kt)("admonition",{type:"note"},(0,o.kt)("p",{parentName:"admonition"},"By default, Edge Functions require a valid JWT in the authorization header. This header is automatically set when invoking your function via a Supabase client library."),(0,o.kt)("p",{parentName:"admonition"},"If you want to use Edge Functions to handle webhooks (e.g. ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/supabase/supabase/tree/master/examples/edge-functions/supabase/functions/stripe-webhooks"},"Stripe payment webhooks")," etc.), you need to pass the ",(0,o.kt)("inlineCode",{parentName:"p"},"--no-verify-jwt")," flag when deploying your function.")),(0,o.kt)("h3",{id:"executing-remote-functions"},"Executing Remote Functions"),(0,o.kt)("p",null,"You can execute Edge Functions using curl. Copy the curl command from the Dashboard. It should look like this:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl --request POST 'https://<project_ref>.functions.supabase.co/hello-world' \\\n  --header 'Authorization: Bearer ANON_KEY' \\\n  --header 'Content-Type: application/json' \\\n  --data '{ \"name\":\"Functions\" }'\n")),(0,o.kt)("p",null,"If you receive an error ",(0,o.kt)("inlineCode",{parentName:"p"},"Invalid JWT"),", find the ",(0,o.kt)("inlineCode",{parentName:"p"},"ANON_KEY")," of your project in the Dashboard under ",(0,o.kt)("inlineCode",{parentName:"p"},"Settings > API"),"."),(0,o.kt)("p",null,"After invoking your Edge Function you should see the response ",(0,o.kt)("inlineCode",{parentName:"p"},'{ "message":"Hello Functions!" }'),"."),(0,o.kt)("h2",{id:"debugging-your-functions"},"Debugging your Functions"),(0,o.kt)("p",null,'You can debug your deployed Edge Functions using the "Functions" section of the Dashboard. There are two types debugging tools available:'),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Invocations: shows the Request and Response for each execution."),(0,o.kt)("li",{parentName:"ul"},"Logs: shows any platform events, including deployments and errors.")),(0,o.kt)("p",null,(0,o.kt)("img",{alt:"Function invocations.",src:n(11814).Z,width:"3238",height:"2138"})),(0,o.kt)("h2",{id:"developing-locally"},"Developing locally"),(0,o.kt)("p",null,"You can run your Edge Function locally using ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/cli/usage#supabase-functions-serve"},(0,o.kt)("inlineCode",{parentName:"a"},"supabase functions serve")),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"supabase start # start the supabase stack\nsupabase functions serve hello-world # start the Function watcher\n")),(0,o.kt)("p",null,"The ",(0,o.kt)("inlineCode",{parentName:"p"},"functions serve")," command has hot-reloading capabilities. It will watch for any changes to your files and restart the Deno server."),(0,o.kt)("h3",{id:"invoking-functions-locally"},"Invoking Functions locally"),(0,o.kt)("p",null,"While serving your local Function, you can execute it using curl:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"curl --request POST 'http://localhost:54321/functions/v1/hello-world' \\\n  --header 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZS1kZW1vIiwicm9sZSI6ImFub24ifQ.625_WdcF3KHqz5amU0x2X5WWHP-OEs_4qj0ssLNHzTs' \\\n  --header 'Content-Type: application/json' \\\n  --data '{ \"name\":\"Functions\" }'\n")),(0,o.kt)("p",null,"You should see the response ",(0,o.kt)("inlineCode",{parentName:"p"},'{ "message":"Hello Functions!" }'),"."),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Implementation details"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"All Edge Functions are ",(0,o.kt)("inlineCode",{parentName:"li"},"POST")," requests."),(0,o.kt)("li",{parentName:"ul"},"The ",(0,o.kt)("inlineCode",{parentName:"li"},"Authorization")," header is required. You can use either the ",(0,o.kt)("inlineCode",{parentName:"li"},"ANON")," key, the ",(0,o.kt)("inlineCode",{parentName:"li"},"SERVICE_ROLE")," key, or a logged-in user's JWT."),(0,o.kt)("li",{parentName:"ul"},"The Function is proxied through the local API (",(0,o.kt)("inlineCode",{parentName:"li"},"http://localhost:54321"),")"))),(0,o.kt)("br",null),(0,o.kt)("p",null,"If you execute Function with a different payload the response will change. ",(0,o.kt)("br",null),"\nModify the ",(0,o.kt)("inlineCode",{parentName:"p"},'--data \'{"name":"Functions"}\'')," line to ",(0,o.kt)("inlineCode",{parentName:"p"},'--data \'{"name":"World"}\'')," and try invoking the command again!"),(0,o.kt)("h2",{id:"secrets-and-environment-variables"},"Secrets and Environment Variables"),(0,o.kt)("p",null,"It's common that you will need to use sensitive information or environment-specific variables inside your Edge Functions. You can access these using Deno's built-in handler"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"Deno.env.get(MY_SECRET_NAME)\n")),(0,o.kt)("h3",{id:"default-secrets"},"Default secrets"),(0,o.kt)("p",null,"By default, Edge Functions have access to these secrets:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"SUPABASE_URL"),": The API gateway for your Supabase project."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"SUPABASE_ANON_KEY"),": The ",(0,o.kt)("inlineCode",{parentName:"li"},"anon")," key for your Supabase API. This is safe to use in a browser when you have ",(0,o.kt)("a",{parentName:"li",href:"/docs/guides/auth/row-level-security"},"Row Level Security")," enabled."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"SUPABASE_SERVICE_ROLE_KEY"),": The ",(0,o.kt)("inlineCode",{parentName:"li"},"service_role")," key for your Supabase API. This is safe to use in Edge Functions, but it should NEVER be used in a browser. This key will bypass ",(0,o.kt)("a",{parentName:"li",href:"/docs/guides/auth/row-level-security"},"Row Level Security"),"."),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("inlineCode",{parentName:"li"},"SUPABASE_DB_URL"),": The URL for your ",(0,o.kt)("a",{parentName:"li",href:"/docs/guides/database"},"PostgreSQL database"),". You can use this to connect directly to your database.")),(0,o.kt)("h3",{id:"local-secrets"},"Local secrets"),(0,o.kt)("p",null,"Let's create a local file for storing our secrets, and inside it we can store a secret ",(0,o.kt)("inlineCode",{parentName:"p"},"MY_NAME"),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},'echo "MY_NAME=Yoda" >> ./supabase/.env.local\n')),(0,o.kt)("p",null,"This creates a new file ",(0,o.kt)("inlineCode",{parentName:"p"},"./supabase/.env.local")," for storing your local development secrets."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Never check your .env files into Git!")),(0,o.kt)("p",null,"Now let's access this environment variable ",(0,o.kt)("inlineCode",{parentName:"p"},"MY_NAME")," inside our Function. Anywhere in your function, add this line:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-jsx"},"console.log(Deno.env.get('MY_NAME'))\n")),(0,o.kt)("p",null,"Now we can invoke our function locally, by serving it with our new ",(0,o.kt)("inlineCode",{parentName:"p"},".env.local")," file:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"supabase functions serve hello-world --env-file ./supabase/.env.local\n")),(0,o.kt)("p",null,"When the function starts you should see the name \u201cYoda\u201d output to the terminal."),(0,o.kt)("h3",{id:"production-secrets"},"Production secrets"),(0,o.kt)("p",null,"Let's create a ",(0,o.kt)("inlineCode",{parentName:"p"},".env")," for production. In this case we'll just use the same as our local secrets:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"cp ./supabase/.env.local ./supabase/.env\n")),(0,o.kt)("p",null,"This creates a new file ",(0,o.kt)("inlineCode",{parentName:"p"},"./supabase/.env")," for storing your production secrets."),(0,o.kt)("admonition",{type:"caution"},(0,o.kt)("p",{parentName:"admonition"},"Never check your ",(0,o.kt)("inlineCode",{parentName:"p"},".env")," files into Git!")),(0,o.kt)("p",null,"Let's push all the secrets from the ",(0,o.kt)("inlineCode",{parentName:"p"},".env")," file to our remote project using ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/cli/usage#supabase-secrets-set"},(0,o.kt)("inlineCode",{parentName:"a"},"supabase secrets set")),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"supabase secrets set --env-file ./supabase/.env\n\n# You can also set secrets individually using:\nsupabase secrets set MY_NAME=Chewbacca\n")),(0,o.kt)("p",null,"You don't need to re-deploy after setting your secrets."),(0,o.kt)("p",null,"To see all the secrets which you have set remotely, use ",(0,o.kt)("a",{parentName:"p",href:"/docs/reference/cli/usage#supabase-secrets-list"},(0,o.kt)("inlineCode",{parentName:"a"},"supabase secrets list")),":"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"supabase secrets list\n")),(0,o.kt)("h2",{id:"suggestions"},"Suggestions"),(0,o.kt)("h3",{id:"database-functions-vs-edge-functions"},"Database Functions vs Edge Functions"),(0,o.kt)("p",null,"For data-intensive operations we recommend using ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/database/functions"},"Database Functions"),", which are executed within your database\nand can be called remotely using the ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/api"},"REST and GraphQL API"),"."),(0,o.kt)("p",null,"For use-cases which require low-latency we recommend ",(0,o.kt)("a",{parentName:"p",href:"/docs/guides/functions"},"Edge Functions"),", which are globally-distributed and can be written in TypeScript."),(0,o.kt)("h3",{id:"organizing-your-edge-functions"},"Organizing your Edge Functions"),(0,o.kt)("p",null,"We recommend developing \u201cfat functions\u201d. This means that you should develop few large functions, rather than many small functions. One common pattern when developing Functions is that you need to share code between two or more Functions. To do this, you can store any shared code in a folder prefixed with an underscore (",(0,o.kt)("inlineCode",{parentName:"p"},"_"),"). We recommend this folder structure:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-bash"},"\u2514\u2500\u2500 supabase\n    \u251c\u2500\u2500 functions\n    \u2502   \u251c\u2500\u2500 _shared\n    \u2502   |   \u251c\u2500\u2500 supabaseAdmin.ts # Supabase client with SERVICE_ROLE key\n    \u2502   \u2502   \u2514\u2500\u2500 supabaseClient.ts # Supabase client with ANON key\n    \u2502   \u251c\u2500\u2500 function-one # use hyphens to name functions\n    \u2502   \u2502   \u2514\u2500\u2500 index.ts\n    \u2502   \u2514\u2500\u2500 function-two\n    \u2502       \u2514\u2500\u2500 index.ts\n    \u251c\u2500\u2500 migrations\n    \u2514\u2500\u2500 config.toml\n")),(0,o.kt)("h3",{id:"naming-edge-functions"},"Naming Edge Functions"),(0,o.kt)("p",null,"We recommend using hyphens to name functions because hyphens are the most URL-friendly of all the naming conventions (snake_case, camelCase, PascalCase)."),(0,o.kt)("h3",{id:"cors-cross-origin-resource-sharing"},"CORS (Cross-Origin Resource Sharing)"),(0,o.kt)("p",null,"We recommend adding a check to handle ",(0,o.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/en-US/docs/Glossary/Preflight_request"},"CORS Preflight")," requests in your edge function to be able to invoke the function from browsers."),(0,o.kt)("p",null,"See the ",(0,o.kt)("a",{parentName:"p",href:"https://github.com/supabase/supabase/blob/master/examples/edge-functions/supabase/functions/browser-with-cors/index.ts"},"example on GitHub"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-ts"},"export const corsHeaders = {\n  'Access-Control-Allow-Origin': '*',\n  'Access-Control-Allow-Headers': 'authorization, x-client-info, apikey',\n}\n\nserve(async (req) => {\n  if (req.method === 'OPTIONS') {\n    return new Response('ok', { headers: corsHeaders })\n  }\n  ...\n})\n")),(0,o.kt)("h2",{id:"limitations"},"Limitations"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Deno Deploy limitations",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Deno does not support outgoing connections to ports ",(0,o.kt)("inlineCode",{parentName:"li"},"25"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"465"),", and ",(0,o.kt)("inlineCode",{parentName:"li"},"587"),"."),(0,o.kt)("li",{parentName:"ul"},"Cannot write to File System"))),(0,o.kt)("li",{parentName:"ul"},"Edge Functions",(0,o.kt)("ul",{parentName:"li"},(0,o.kt)("li",{parentName:"ul"},"Local development - only one function at a time"),(0,o.kt)("li",{parentName:"ul"},"Supabase Functions only supports ",(0,o.kt)("inlineCode",{parentName:"li"},"POST"),", ",(0,o.kt)("inlineCode",{parentName:"li"},"OPTIONS"),", and ",(0,o.kt)("inlineCode",{parentName:"li"},"GET")," requests."),(0,o.kt)("li",{parentName:"ul"},"Serving of HTML content is not supported (",(0,o.kt)("inlineCode",{parentName:"li"},"GET")," requests that return ",(0,o.kt)("inlineCode",{parentName:"li"},"text/html")," will be rewritten to ",(0,o.kt)("inlineCode",{parentName:"li"},"text/plain"),").")))))}p.isMDXComponent=!0},11814:(e,t,n)=>{n.d(t,{Z:()=>a});const a=n.p+"assets/images/function-logs-6bb775cb56b3ebc589c4dae16b0029e1.png"}}]);